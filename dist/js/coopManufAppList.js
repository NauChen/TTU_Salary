$(function(){$("#cooperativeManufacturersApplicationList").DataTable({...commonSettingsTable,data:dataset_coopManufApp,columns:[{data:"createDate",title:"申請日期"},{data:"uniformNum",title:"統一編號",className:"text-md-center"},{data:"company",title:"公司名稱"},{data:"contactPerson",title:"主要聯絡人"},{data:"companyEmail",title:"E-mail"},{data:"status",title:"審核進度"},{data:"id",title:"檢閱",render:function(e,t,a){return"通過"==a.status||"不通過"==a.status?'<button type="button" class="btn btn-outline-primary rounded-circle btn-sm" data-bs-toggle="modal" data-bs-target="#vendorDetailModal" data-id="'+e+'"><i class="fa-solid fa-paperclip"></i></button>':'<button type="button" class="btn btn-info rounded-circle btn-sm" data-bs-toggle="modal" data-bs-target="#vendorDetailModal" data-id="'+e+'"><i class="fa-solid fa-paperclip"></i></button>'}}],columnDefs:[{targets:[0],responsivePriority:1},{targets:[2],responsivePriority:2},{targets:[3],responsivePriority:2},{searchable:!1,orderable:!1,targets:[6]},{className:"text-nowrap",targets:[0,1,4,5,6]},{className:"text-lg-center",targets:[0,5,6]}],createdRow:function(t,e,a){$("td:eq(6)",t).css("min-width","70px"),[0,1].forEach(function(e){$("td:eq("+e+")",t).css("min-width","130px").css("font-size",".95em")})}}),$("#vendorDetailModal").on("show.bs.modal",function(t){t=$(t.relatedTarget);let a=String(t.data("id"));$("#updateBtn").off("click");t=dataset_coopManufApp.find(e=>e.id===a);if(t){$("#companyName").text(t.company),$("#createDate").text(t.createDate),$("#companyDescription").text(t.companyDescription),$("#uniformNum").text(t.uniformNum),$("#creationDate").text(t.creationDate),$("#capitalAmount").text(t.capitalAmount),$("#employeesNum").text(t.employeesNum),$("#responsiblePerson").text(t.responsiblePerson),$("#referrer").text(t.referrer),$("#phoneNum").text(t.phone),$("#companyEmail").text(t.companyEmail),$("#lineId").text(t.lineId),$("#contactPerson").text(t.contactPerson),$("#ext").text(t.ext),$("#jobTitle").text(t.jobTitle),$("#companyAdd").text(t.companyAdd),$("#locationOfCompany").text(t.locationOfCompany),$("#helpItems").html(t.helpItems),$("#tutoringProfessor").text(t.tutoringProfessor),$("#nurtureProgram").text(t.nurtureProgram),$("#adminNote").html(t.adminNote),"待審核"!=t.status&&$("#status").val(t.status);let e="";function o(e,t,a,o){e=extractSubstringBetween(e,"_",".");return console.log(o+"_No = ",e),e==o+"1"?`<a class="d-inline me-3" href="/download/${o}_${t}">${a}&ensp;<i class="fa-solid fa-download"></i></a>`:`<a class="d-inline me-3" href="/download/${o}_${t}">${a}&ensp;<i class="fa-solid fa-download"></i><span class="mx-1 update">補</span></a>`}t.companyProof&&(e+=o(t.companyProof,a,"公司登記證","CP")),t.businessProof&&(e+=o(t.businessProof,a,"營利事業登記證或預查名稱表影本","BP")),t.memoOfCooperation&&(e+=o(t.memoOfCooperation,a,"企業與大同大學教職員簽訂之合作備忘錄","MOC")),t.planConcept&&(e+=o(t.planConcept,a,"企業營運計畫構想書","PC")),t.entryForm&&(e+=o(t.entryForm,a,"創新育成中心進駐申請書","EF")),t.consentDoc&&(e+=o(t.consentDoc,a,"同意審查聲明書","CD")),t.payProof&&(e+=o(t.payProof,a,"進駐審查費繳費證明","PP")),$("#downloadLinksContainer").html(e)}else console.error("firmData data not found for id:",a);"通過"===t.status||"不通過"===t.status?(CustomInputHandlers.destroy(),$("#companyName, #responsiblePerson, #referrer, #contactPerson, #jobTitle,#companyAdd, #locationOfCompany, #tutoringProfessor, #nurtureProgram").removeClass("changeInput_items"),$("#companyDescription, #helpItems, #adminNote").removeClass("changeTextarea_lg_items"),$("#uniformNum, #ext").removeClass("changeUniformNum_items"),$("#creationDate").removeClass("changeDate_items"),$("#capitalAmount, #changeMoney_items, #employeesNum").removeClass("changeMoney_items"),$("#phoneNum").removeClass("changePhone_items"),$("#companyEmail").removeClass("changeEmail_items"),$("#lineId").removeClass("changeLineID_items"),$("#companyName, #responsiblePerson, #referrer, #contactPerson, #jobTitle,#companyAdd, #locationOfCompany, #tutoringProfessor, #nurtureProgram, #adminNote, #companyDescription, #helpItems, #uniformNum, #ext, #creationDate, #capitalAmount, #changeMoney_items, #phoneNum, #companyEmail, #lineId, #employeesNum").addClass("readOnly"),$("#updateBtn").hide(),$("#supplementaryFilesBox").hide(),$("#status").hide(),$("#statusText").show().text(t.status)):($("#companyName, #responsiblePerson, #referrer, #contactPerson, #jobTitle,#companyAdd, #locationOfCompany, #tutoringProfessor, #nurtureProgram").addClass("changeInput_items"),$("#companyDescription, #helpItems, #adminNote").addClass("changeTextarea_lg_items"),$("#uniformNum, #ext").addClass("changeUniformNum_items"),$("#creationDate").addClass("changeDate_items"),$("#capitalAmount, #changeMoney_items, #employeesNum").addClass("changeMoney_items"),$("#phoneNum").addClass("changePhone_items"),$("#companyEmail").addClass("changeEmail_items"),$("#lineId").addClass("changeLineID_items"),$("#companyName, #responsiblePerson, #referrer, #contactPerson, #jobTitle,#companyAdd, #locationOfCompany, #tutoringProfessor, #nurtureProgram, #adminNote, #companyDescription, #helpItems, #uniformNum, #ext, #creationDate, #capitalAmount, #changeMoney_items, #phoneNum, #companyEmail, #lineId, #employeesNum").removeClass("readOnly"),CustomInputHandlers.init(),$("#updateBtn").show(),$("#supplementaryFilesBox").show(),$("#status").show(),$("#statusText").hide()),$("#updateBtn").click(function(){var e=new FormData($("#formCoopManufApp")[0]);e.append("id",a),e.append("companyName",$("#companyName").text()),e.append("companyDescription",$("#companyDescription").text()),e.append("uniformNum",$("#uniformNum").text()),e.append("creationDate",$("#creationDate").text()),e.append("capitalAmount",$("#capitalAmount").text()),e.append("employeesNum",$("#employeesNum").text()),e.append("responsiblePerson",$("#responsiblePerson").text()),e.append("referrer",$("#referrer").text()),e.append("phoneNum",$("#phoneNum").text()),e.append("companyEmail",$("#companyEmail").text()),e.append("lineId",$("#lineId").text()),e.append("contactPerson",$("#contactPerson").text()),e.append("ext",$("#ext").text()),e.append("jobTitle",$("#jobTitle").text()),e.append("companyAdd",$("#companyAdd").text()),e.append("locationOfCompany",$("#locationOfCompany").text()),e.append("helpItems",convertBrToNewline($("#helpItems").html())),e.append("tutoringProfessor",$("#tutoringProfessor").text()),e.append("adminNote",convertBrToNewline($("#adminNote").html())),$.ajax({url:reviewCompanyUrl,type:"POST",data:e,contentType:!1,processData:!1,success:function(e){swalToastSuccess(e.message,"top"),setTimeout(function(){$("#vendorDetailModal").modal("hide"),location.replace(location.href)},2300)},error:function(e,t,a){swalToastError("提交失敗，請稍後再試。","top")}})})})});