$(function(){$("#cooperativeManufacturersApplicationList").DataTable({...commonSettingsTable,data:dataset_coopManufApp,columns:[{data:"createDate",title:"申請日期"},{data:"uniformNum",title:"統一編號",className:"text-md-center"},{data:"company",title:"公司名稱"},{data:"contactPerson",title:"主要聯絡人"},{data:"companyEmail",title:"E-mail"},{data:"status",title:"審核進度"},{data:"id",title:"檢閱",render:function(e,t,a){return"通過"==a.status||"不通過"==a.status?'<button type="button" class="btn btn-outline-primary rounded-circle btn-sm" data-bs-toggle="modal" data-bs-target="#vendorDetailModal" data-id="'+e+'"><i class="fa-solid fa-paperclip"></i></button>':'<button type="button" class="btn btn-info rounded-circle btn-sm" data-bs-toggle="modal" data-bs-target="#vendorDetailModal" data-id="'+e+'"><i class="fa-solid fa-paperclip"></i></button>'}}],columnDefs:[{targets:[0],responsivePriority:1},{targets:[2],responsivePriority:2},{targets:[3],responsivePriority:2},{searchable:!1,orderable:!1,targets:[6]},{className:"text-nowrap",targets:[0,1,4,5,6]},{className:"text-lg-center",targets:[0,5,6]}],createdRow:function(t,e,a){$("td:eq(6)",t).css("min-width","70px"),[0,1].forEach(function(e){$("td:eq("+e+")",t).css("min-width","130px").css("font-size",".95em")})}}),$("#vendorDetailModal").on("show.bs.modal",function(e){e=$(e.relatedTarget);let o=String(e.data("id"));$("#updateBtn").off("click");e=dataset_coopManufApp.find(e=>e.id===o);e?($("#companyName").text(e.company),$("#createDate").text(e.createDate),$("#companyDescription").text(e.companyDescription),$("#uniformNum").text(e.uniformNum),$("#creationDate").text(e.creationDate),$("#capitalAmount").text(e.capitalAmount),$("#employeesNum").text(e.employeesNum),$("#responsiblePerson").text(e.responsiblePerson),$("#referrer").text(e.referrer),$("#phoneNum").text(e.phone),$("#companyEmail").text(e.companyEmail),$("#lineId").text(e.lineId),$("#contactPerson").text(e.contactPerson),$("#ext").text(e.ext),$("#jobTitle").text(e.jobTitle),$("#companyAdd").text(e.companyAdd),$("#locationOfCompany").text(e.locationOfCompany),$("#helpItems").text(e.helpItems),$("#tutoringProfessor").text(e.tutoringProfessor),$("#nurtureProgram").text(e.nurtureProgram),$("#adminNote").text(e.adminNote),"待審核"!=e.status&&$("#status").val(e.status)):console.error("firmData data not found for id:",o),"通過"===e.status||"不通過"===e.status?(CustomInputHandlers.destroy(),$("#companyName, #responsiblePerson, #referrer, #contactPerson, #jobTitle,#companyAdd, #locationOfCompany, #tutoringProfessor, #nurtureProgram").removeClass("changeInput_items"),$("#companyDescription, #helpItems, #adminNote").removeClass("changeTextarea_lg_items"),$("#uniformNum, #ext").removeClass("changeUniformNum_items"),$("#creationDate").removeClass("changeDate_items"),$("#capitalAmount, #changeMoney_items, #employeesNum").removeClass("changeMoney_items"),$("#phoneNum").removeClass("changePhone_items"),$("#companyEmail").removeClass("changeEmail_items"),$("#lineId").removeClass("changeLineID_items"),$("#companyName, #responsiblePerson, #referrer, #contactPerson, #jobTitle,#companyAdd, #locationOfCompany, #tutoringProfessor, #nurtureProgram, #adminNote, #companyDescription, #helpItems, #uniformNum, #ext, #creationDate, #capitalAmount, #changeMoney_items, #phoneNum, #companyEmail, #lineId, #employeesNum").addClass("readOnly"),$("#updateBtn").hide(),$("#supplementaryFilesBox").hide(),$("#status").hide(),$("#statusText").show().text(e.status)):($("#companyName, #responsiblePerson, #referrer, #contactPerson, #jobTitle,#companyAdd, #locationOfCompany, #tutoringProfessor, #nurtureProgram").addClass("changeInput_items"),$("#companyDescription, #helpItems, #adminNote").addClass("changeTextarea_lg_items"),$("#uniformNum, #ext").addClass("changeUniformNum_items"),$("#creationDate").addClass("changeDate_items"),$("#capitalAmount, #changeMoney_items, #employeesNum").addClass("changeMoney_items"),$("#phoneNum").addClass("changePhone_items"),$("#companyEmail").addClass("changeEmail_items"),$("#lineId").addClass("changeLineID_items"),$("#companyName, #responsiblePerson, #referrer, #contactPerson, #jobTitle,#companyAdd, #locationOfCompany, #tutoringProfessor, #nurtureProgram, #adminNote, #companyDescription, #helpItems, #uniformNum, #ext, #creationDate, #capitalAmount, #changeMoney_items, #phoneNum, #companyEmail, #lineId, #employeesNum").removeClass("readOnly"),CustomInputHandlers.init(),$("#updateBtn").show(),$("#supplementaryFilesBox").show(),$("#status").show(),$("#statusText").hide()),$("#updateBtn").click(function(){let a=new FormData;a.append("id",o),a.append("companyName",$("#companyName").text()),a.append("companyDescription",$("#companyDescription").text()),a.append("uniformNum",$("#uniformNum").text()),a.append("creationDate",$("#creationDate").text()),a.append("capitalAmount",$("#capitalAmount").text()),a.append("employeesNum",$("#employeesNum").text()),a.append("responsiblePerson",$("#responsiblePerson").text()),a.append("referrer",$("#referrer").text()),a.append("phoneNum",$("#phoneNum").text()),a.append("companyEmail",$("#companyEmail").text()),a.append("lineId",$("#lineId").text()),a.append("contactPerson",$("#contactPerson").text()),a.append("ext",$("#ext").text()),a.append("jobTitle",$("#jobTitle").text()),a.append("companyAdd",$("#companyAdd").text()),a.append("locationOfCompany",$("#locationOfCompany").text()),a.append("helpItems",$("#helpItems").text()),a.append("tutoringProfessor",$("#tutoringProfessor").text()),a.append("adminNote",$("#adminNote").text()),a.append("status",$("#status").val());var e,t;["companyProof","memoUpload","consentDoc","businessProof","planUpload","entryForm","payProof"].forEach(e=>{var t=$("#"+e)[0].files[0];t&&a.append(e,t)});for([e,t]of a.entries())console.log(e,t);$.ajax({url:reviewCompanyUrl,type:"POST",data:a,contentType:!1,processData:!1,success:function(e){swalToastSuccess(e.message,"top"),setTimeout(function(){$("#vendorDetailModal").modal("hide")},2300)},error:function(e,t,a){swalToastError("提交失敗，請稍後再試。","top")}})})})});