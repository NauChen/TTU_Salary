var dataset_confirmPaymentParkingSpace=[{id:"1",psId:"11",building:"新德惠大樓",carType:"汽車",parkingSpaceNum:"B1-01",startDate:"2024-07-01",endDate:"2025-06-30",amount:"3,000",licensePlateNum:"1234-AB",company:"偉大企業有限公司",uniformNum:"12345678",applicant:"張偉",email:"wei@awesome.com",phone:"02-86711234",deadline1:"2024-10-01",deadline2:"2025-01-01",deadline3:"2025-04-01",deadline4:"2025-06-20",receiptNum1:"RM123456",receiptNum2:"RM234567",receiptNum3:"RM345678",receiptNum4:"RM456789",receivedDate1:"2024-09-28",receivedDate2:"2024-12-28",receivedDate3:"2025-03-28",receivedDate4:"2025-06-17",adminNote:""},{id:"2",psId:"12",building:"校本部",carType:"機車",parkingSpaceNum:"05",startDate:"2024-08-01",endDate:"2025-01-31",amount:"100",licensePlateNum:"1AA-123",company:"頂尖科技股份有限公司",uniformNum:"23456789",applicant:"李頂",email:"ting@toptech.com",phone:"0912-345678",deadline1:"2024-11-01",deadline2:"2025-01-21",deadline3:"2025-02-01",deadline4:"",receiptNum1:"RM567890",receiptNum2:"RM678901",receiptNum3:"",receiptNum4:"",receivedDate1:"2024-10-29",receivedDate2:"2025-01-18",receivedDate3:"",receivedDate4:"",adminNote:""},{id:"3",psId:"13",building:"新德惠大樓",carType:"汽車",parkingSpaceNum:"B2-12",startDate:"2024-09-01",endDate:"2025-02-28",amount:"2,500",licensePlateNum:"5678-CD",company:"創意股份有限公司",uniformNum:"34567890",applicant:"林創",email:"chuang@creative.com",phone:"02-86719876",deadline1:"2024-12-01",deadline2:"2025-02-18",deadline3:"2025-03-01",deadline4:"",receiptNum1:"RM789012",receiptNum2:"RM890123",receiptNum3:"",receiptNum4:"",receivedDate1:"2024-11-28",receivedDate2:"2025-02-15",receivedDate3:"",receivedDate4:"",adminNote:""},{id:"4",psId:"14",building:"校本部",carType:"機車",parkingSpaceNum:"12",startDate:"2024-07-15",endDate:"2025-07-14",amount:"100",licensePlateNum:"2BB-456",company:"華麗有限公司",uniformNum:"45678901",applicant:"周華",email:"hua@glamorous.com",phone:"0912-876543",deadline1:"2024-10-15",deadline2:"2025-01-15",deadline3:"2025-04-15",deadline4:"2025-07-04",receiptNum1:"RM890124",receiptNum2:"RM901235",receiptNum3:"RM012346",receiptNum4:"RM123457",receivedDate1:"2024-10-12",receivedDate2:"2025-01-12",receivedDate3:"2025-04-12",receivedDate4:"2025-07-01",adminNote:""},{id:"5",psId:"15",building:"新德惠大樓",carType:"汽車",parkingSpaceNum:"B3-03",startDate:"2024-08-01",endDate:"2025-07-31",amount:"2,500",licensePlateNum:"2345-EF",company:"豪華國際股份有限公司",uniformNum:"56789012",applicant:"陳豪",email:"hao@luxury.com",phone:"02-86713456",deadline1:"2024-11-01",deadline2:"2025-02-01",deadline3:"2025-05-01",deadline4:"2025-07-21",receiptNum1:"RM234568",receiptNum2:"RM345679",receiptNum3:"RM456780",receiptNum4:"RM567891",receivedDate1:"2024-10-29",receivedDate2:"2025-01-29",receivedDate3:"2025-04-29",receivedDate4:"2025-07-18",adminNote:""},{id:"6",psId:"16",building:"校本部",carType:"機車",parkingSpaceNum:"21",startDate:"",endDate:"",amount:"100",licensePlateNum:"3CC-789",company:"",uniformNum:"",applicant:"",email:"",phone:"",deadline1:"",deadline2:"",deadline3:"",deadline4:"",receiptNum1:"",receiptNum2:"",receiptNum3:"",receiptNum4:"",receivedDate1:"",receivedDate2:"",receivedDate3:"",receivedDate4:"",adminNote:""},{id:"7",psId:"17",building:"新德惠大樓",carType:"汽車",parkingSpaceNum:"B1-09",startDate:"2024-09-01",endDate:"2024-11-30",amount:"3,000",licensePlateNum:"6789-GH",company:"高效能股份有限公司",uniformNum:"67890123",applicant:"劉效",email:"xiao@efficient.com",phone:"02-86717890",deadline1:"2024-12-01",deadline2:"2025-03-01",deadline3:"2024-11-20",deadline4:"",receiptNum1:"RM678912",receiptNum2:"RM789023",receiptNum3:"",receiptNum4:"",receivedDate1:"2024-11-28",receivedDate2:"2024-11-17",receivedDate3:"",receivedDate4:"",adminNote:""},{id:"8",psId:"18",building:"校本部",carType:"機車",parkingSpaceNum:"31",startDate:"2024-07-01",endDate:"2025-06-30",amount:"100",licensePlateNum:"4DD-123",company:"先進科技有限公司",uniformNum:"78901234",applicant:"周先",email:"xian@advancedtech.com",phone:"0912-987654",deadline1:"2024-10-01",deadline2:"2025-01-01",deadline3:"2025-04-01",deadline4:"2025-06-20",receiptNum1:"RM890125",receiptNum2:"RM901236",receiptNum3:"RM012347",receiptNum4:"RM123458",receivedDate1:"2024-09-28",receivedDate2:"2024-12-28",receivedDate3:"2025-03-28",receivedDate4:"2025-06-17",adminNote:""},{id:"9",psId:"19",building:"新德惠大樓",carType:"汽車",parkingSpaceNum:"B4-15",startDate:"2024-08-01",endDate:"2025-07-31",amount:"2,500",licensePlateNum:"3456-IJ",company:"精英國際股份有限公司",uniformNum:"89012345",applicant:"吳精",email:"jing@elite.com",phone:"02-86712345",deadline1:"2024-11-01",deadline2:"2025-02-01",deadline3:"2025-05-01",deadline4:"2025-07-21",receiptNum1:"RM123459",receiptNum2:"RM234570",receiptNum3:"RM345681",receiptNum4:"RM456792",receivedDate1:"2024-10-29",receivedDate2:"2025-01-29",receivedDate3:"2025-04-29",receivedDate4:"2025-07-18",adminNote:""},{id:"10",psId:"20",building:"校本部",carType:"機車",parkingSpaceNum:"44",startDate:"2024-09-01",endDate:"2024-11-30",amount:"100",licensePlateNum:"5EE-456",company:"新創有限公司",uniformNum:"90123456",applicant:"蔡新",email:"xin@newstartup.com",phone:"0912-876543",deadline1:"2024-12-01",deadline2:"2024-11-20",deadline3:"",deadline4:"",receiptNum1:"RM678913",receiptNum2:"RM789024",receiptNum3:"",receiptNum4:"",receivedDate1:"2024-11-28",receivedDate2:"2024-11-17",receivedDate3:"",receivedDate4:"",adminNote:""}],parkingSpaceCarData=["B1-01","B1-02","B2-03","B3-04","B2-05","B2-07","B3-11"],parkingSpaceMotoData=["B1-21","B1-22","B2-23","B3-24","B2-25","B2-26","B3-27"],idCardData=["N000030","N000051","N000040","N000089","N000012","N000060","N000070"],roomData=["新德惠大樓/101","綜合大樓/201","挺生大樓/714","實驗大樓/101","北設工大樓/713","綜合大樓/A4-102","挺生大樓/809"],selectOptionPaymentPurpose=[{option:"新申請"},{option:"補發"},{option:"續約"},{option:"階段費用"}],selectOptionPurchase=[{option:"汽車位"},{option:"機車位"},{option:"識別證"},{option:"培育室"}],companyData=["超級棒股份有限公司","大富翁科技有限公司","迅捷物流股份有限公司","綠能科技有限公司","全球股份有限公司","宇宙科技有限公司","光速科技有限公司"],selectOptionStatus2=[{option:"使用中"},{option:"作廢收回"},{option:"刪除"}],selectOptionStatus=[{option:"待確認"},{option:"完成"},{option:"取消"},{option:"刪除"}],selectOption=[{option:"1"},{option:"2"},{option:"3"},{option:"4"}];$(function(){$("#confirmPaymentReceiptList").DataTable({...commonSettingsTable,data:dataset_confirmPaymentReceipt,columns:[{data:"createDate",title:"建立日期"},{data:"receiptNum",title:"收據號碼"},{data:"receiptDate",title:"收據日期",className:"text-center"},{data:"item",title:"收據項目"},{data:"amount",title:"收據<br class='d-none d-lg-block'>總額"},{data:"company",title:"收據抬頭"},{data:"uniformNum",title:"收據統編"},{data:"adminNote",title:"管理備註"},{data:"id",title:"操作",render:function(e,t,a){a=a.status;return"使用中"==!a||"作廢收回"==a?'<button type="button" class="btn btn-outline-primary rounded-circle btn-sm" data-bs-toggle="modal" data-bs-target="#confirmPaymentReceiptModel" data-id="'+e+'"><i class="fa-solid fa-wrench"></i>':'<button type="button" class="btn btn-info rounded-circle btn-sm" data-bs-toggle="modal" data-bs-target="#confirmPaymentReceiptModel" data-id="'+e+'" title="登記收據資訊"><i class="fa-solid fa-wrench"></i>'},className:"text-nowrap"},{data:"status",visible:!1}],order:[[1,"desc"]],columnDefs:[{targets:[1],responsivePriority:1},{targets:[2],responsivePriority:2},{targets:[3],responsivePriority:3},{searchable:!1,orderable:!1,targets:[8]},{className:"text-lg-center",targets:[0,2,6,8]},{className:"text-nowrap",targets:[0,1,2,4,6,8]}],createdRow:function(t,e,a){$("td:eq(8)",t).css("min-width","70px"),[0,2].forEach(function(e){$("td:eq("+e+")",t).css("min-width","130px")}),[0,2,5,6].forEach(function(e){$("td:eq("+e+")",t).css("font-size",".9em")})}}),$("#confirmPaymentAllList").DataTable({...commonSettingsTable,data:dataset_confirmPaymentAll,columns:[{data:"createDate",title:"通知日期"},{data:"company",title:"通知公司"},{data:"paymentDate",title:"付款日",className:"text-center"},{data:"amount",title:"付款金額"},{data:"adminNote",title:"管理備註"},{data:"id",title:"操作",render:function(e,t,a){a=a.status;return"完成"==a||"取消"==a?'<button type="button" class="btn btn-outline-primary rounded-circle btn-sm" data-bs-toggle="modal" data-bs-target="#confirmPaymentModel" data-id="'+e+'"><i class="fa-solid fa-info px-1"></i>':'<button type="button" class="btn btn-info rounded-circle btn-sm" data-bs-toggle="modal" data-bs-target="#confirmPaymentModel" data-id="'+e+'" title="登記收據資訊"><i class="fa-solid fa-info px-1"></i>'}},{data:"status",visible:!1}],order:[[6,"desc"],[0,"desc"],[2,"desc"]],columnDefs:[{targets:[1],responsivePriority:1},{targets:[2],responsivePriority:2},{targets:[3],responsivePriority:3},{searchable:!1,orderable:!1,targets:[5]},{className:"text-lg-center",targets:[0,2,5]},{className:"text-nowrap",targets:[0,2,5]}],createdRow:function(t,e,a){$("td:eq(5)",t).css("min-width","70px"),$("td:eq(1)",t).css("min-width","150px"),[0,2,3,4].forEach(function(e){$("td:eq("+e+")",t).css("font-size",".9em")})}}),$("#confirmPaymentCultivationRoomList").DataTable({...commonSettingsTable,data:dataset_confirmPaymentCultivationRoom,columns:[{data:"building",title:"大樓"},{data:"room",title:"室"},{data:"defaultAmount",title:"預設<br class='d-none d-lg-block'>費用"},{title:"配置公司",data:function(e){return e.now.company||"-"}},{title:"階段&#10102;",data:function(e){var t=new Date,a=new Date(e.now.deadline1);return e.now.receivedDate1?'<span><i class="fa-solid fa-sack-dollar"></i> '+e.now.receivedDate1+"</span>":e.now.deadline1?a<t?'<span class="text-danger"><i class="fa-regular fa-calendar-days"></i> '+e.now.deadline1+"</span>":'<span><i class="fa-regular fa-calendar-days"></i> '+e.now.deadline1+"</span>":"-"}},{title:"階段&#10103;",data:function(e){var t=new Date,a=new Date(e.now.deadline2);return e.now.receivedDate2?'<span><i class="fa-solid fa-sack-dollar"></i> '+e.now.receivedDate2+"</span>":e.now.deadline2?a<t?'<span class="text-danger"><i class="fa-regular fa-calendar-days"></i> '+e.now.deadline2+"</span>":'<span><i class="fa-regular fa-calendar-days"></i> '+e.now.deadline2+"</span>":"-"}},{title:"階段&#10104;",data:function(e){var t=new Date,a=new Date(e.now.deadline3);return e.now.receivedDate3?'<span><i class="fa-solid fa-sack-dollar"></i> '+e.now.receivedDate3+"</span>":e.now.deadline3?a<t?'<span class="text-danger"><i class="fa-regular fa-calendar-days"></i> '+e.now.deadline3+"</span>":'<span><i class="fa-regular fa-calendar-days"></i> '+e.now.deadline3+"</span>":"-"}},{title:"階段&#10105;",data:function(e){var t=new Date,a=new Date(e.now.deadline4);return e.now.receivedDate4?'<span><i class="fa-solid fa-sack-dollar"></i> '+e.now.receivedDate4+"</span>":e.now.deadline4?a<t?'<span class="text-danger"><i class="fa-regular fa-calendar-days"></i> '+e.now.deadline4+"</span>":'<span><i class="fa-regular fa-calendar-days"></i> '+e.now.deadline4+"</span>":"-"}},{title:"操作",data:function(e){return e.now.id?'<button type="button" class="btn btn-outline-primary rounded-circle btn-sm" data-bs-toggle="modal" data-bs-target="#confirmPaymentCultivationModel" data-id="now_'+e.roomId+'" title="修改"><i class="fa-solid fa-wrench"></i></button>':'<button type="button" class="btn btn-outline-primary rounded-circle btn-sm wide_icon" data-bs-toggle="modal" data-bs-target="#confirmPaymentCultivationModel" data-id="def_'+e.roomId+'" title="配置進駐廠商"><i class="fa-regular fa-keyboard"></i></button>'}},{title:"下期",data:function(e){return e.now.id?'<button type="button" class="btn btn-outline-primary rounded-circle btn-sm wide_icon" data-bs-toggle="modal" data-bs-target="#confirmPaymentCultivationModel" data-id="next_'+e.roomId+'" title="配置下期進駐廠商"><i class="fa-regular fa-keyboard"></i></button>':""}},{data:"recentMaturityDate",visible:!1}],order:[[10,"asc"],[0,"desc"]],columnDefs:[{targets:[0],responsivePriority:1},{targets:[1],responsivePriority:2},{targets:[3],responsivePriority:3},{searchable:!1,orderable:!1,targets:[8,9,10]},{className:"text-lg-center",targets:[1,4,5,6,7,8,9]},{className:"text-nowrap",targets:[0,1,2,4,5,6,7,8,9]}],createdRow:function(t,e,a){[8,9].forEach(function(e){$("td:eq("+e+")",t).css("max-width","70px")}),[0,1,2,3,4,5,6,7].forEach(function(e){$("td:eq("+e+")",t).css("font-size",".9em")})}}),dataset_confirmPaymentParkingSpace.forEach(e=>{e.company?e.deadline4?e.receivedDate4?e.recentMaturityDate="0":e.receiptNum3?e.recentMaturityDate=e.deadline4:e.recentMaturityDate=e.deadline3:e.deadline3?e.receivedDate3?e.recentMaturityDate="0":e.receiptNum2?e.recentMaturityDate=e.deadline3:e.recentMaturityDate=e.deadline2:e.deadline2?e.receivedDate2?e.recentMaturityDate="0":e.receiptNum1?e.recentMaturityDate=e.deadline2:e.recentMaturityDate=e.deadline1:e.receivedDate1?e.recentMaturityDate="0":e.recentMaturityDate=e.deadline1:e.recentMaturityDate=""}),$("#confirmPaymentParkingSpaceList").DataTable({...commonSettingsTable,data:dataset_confirmPaymentParkingSpace,columns:[{data:"building",title:"大樓"},{data:"parkingSpaceNum",title:"車位<br class='d-none d-lg-block'>號碼"},{data:"amount",title:"費用"},{data:"company",title:"承租公司",render:function(e){return null===e||""==e?"-":e}},{data:"deadline1",title:"階段&#10102;",render:function(e,t,a){var a=a.receivedDate1,i=new Date,n=new Date(e);return a?'<span><i class="fa-solid fa-sack-dollar"></i> '+a+"</span>":e?n<i?'<span class="text-danger"><i class="fa-regular fa-calendar-days"></i> '+e+"</span>":'<span><i class="fa-regular fa-calendar-days"></i> '+e+"</span>":"-"}},{data:"deadline2",title:"階段&#10103;",render:function(e,t,a){var a=a.receivedDate2,i=new Date,n=new Date(e);return a?'<span><i class="fa-solid fa-sack-dollar"></i> '+a+"</span>":e?n<i?'<span class="text-danger"><i class="fa-regular fa-calendar-days"></i> '+e+"</span>":'<span><i class="fa-regular fa-calendar-days"></i> '+e+"</span>":"-"}},{data:"deadline3",title:"階段&#10104;",render:function(e,t,a){var a=a.receivedDate3,i=new Date,n=new Date(e);return a?'<span><i class="fa-solid fa-sack-dollar"></i> '+a+"</span>":e?n<i?'<span class="text-danger"><i class="fa-regular fa-calendar-days"></i> '+e+"</span>":'<span><i class="fa-regular fa-calendar-days"></i> '+e+"</span>":"-"}},{data:"deadline4",title:"階段&#10105;",render:function(e,t,a){var a=a.receivedDate4,i=new Date,n=new Date(e);return a?'<span><i class="fa-solid fa-sack-dollar"></i> '+a+"</span>":e?n<i?'<span class="text-danger"><i class="fa-regular fa-calendar-days"></i> '+e+"</span>":'<span><i class="fa-regular fa-calendar-days"></i> '+e+"</span>":"-"}},{data:"id",title:"操作",render:function(e,t,a){var i=a.company,a=a.psId;return i?'<button type="button" class="btn btn-outline-primary rounded-circle btn-sm" data-bs-toggle="modal" data-bs-target="#confirmPaymentParkingSpaceModel" data-id="'+e+'" title="修改"><i class="fa-solid fa-wrench"></i>':'<button type="button" class="btn btn-outline-primary rounded-circle btn-sm wide_icon" data-bs-toggle="modal" data-bs-target="#confirmPaymentParkingSpaceModel" data-id="'+a+'_N" title="配置進駐廠商"><i class="fa-regular fa-keyboard"></i>'}},{data:"id",title:"下期",render:function(e,t,a){var i=a.psId;return a.company?'<button type="button" class="btn btn-outline-primary rounded-circle btn-sm wide_icon" data-bs-toggle="modal" data-bs-target="#confirmPaymentParkingSpaceModel" data-id="'+i+'_N" title="配置下期進駐廠商"><i class="fa-regular fa-keyboard"></i>':""}},{data:"recentMaturityDate",visible:!1}],order:[[10,"asc"],[0,"desc"]],columnDefs:[{targets:[0],responsivePriority:1},{targets:[1],responsivePriority:2},{targets:[2],responsivePriority:3},{searchable:!1,orderable:!1,targets:[8,9,10]},{className:"text-lg-center",targets:[0,4,5,6,7,8,9]},{className:"text-center",targets:[0,1]},{className:"text-nowrap",targets:[0,1,2,4,5,6,7,8,9]},{className:"p-1",targets:[4,5,6,7]}],createdRow:function(t,e,a){[8,9].forEach(function(e){$("td:eq("+e+")",t).css("max-width","70px")}),[0,1,2,4,5,6,7].forEach(function(e){$("td:eq("+e+")",t).css("font-size",".9em")}),$("td:eq(3)",t).css("min-width","150px")}})}),$(function(){$("#receiptCreateSubmit").click(function(e){e.preventDefault(),checkRequiredElements()&&(checkDangerElements()?($("#formReceiptCreate").submit(),swalToastSuccess("收據新增成功，請靜待畫面更新！","top"),setTimeout(function(){location.reload()},2300)):swalToastWarning("請填上正確資料唷！","top"))}),$("#confirmPaymentReceiptModel").on("show.bs.modal",function(e){e=$(e.relatedTarget);let t=String(e.data("id"));$("#receipt_updateBtn").off("click"),$("#danger_receiptBox").text("");e=dataset_confirmPaymentReceipt.find(e=>e.id===t);e?($("#receipt_receiptNum").text(e.receiptNum),$("#receipt_receiptDate").text(e.receiptDate),$("#receipt_receiptItem").text(e.item),$("#receipt_receiptAmount").text(e.amount),$("#receipt_companyName").text(e.company),$("#receipt_uniformNum").text(e.uniformNum),$("#receipt_status").text(e.status),$("#receipt_adminNote").text(e.adminNote),$("#receipt_createDate").text(e.createDate),$("#receipt_createBy").text(e.createBy)):console.error("資料找不到ID：",t),"使用中"===e.status?($("#receipt_receiptNum").addClass("changeInputUpperNumber_items"),$("#receipt_receiptDate").addClass("changeDate_items"),$("#receipt_receiptItem, #receipt_companyName, #receipt_adminNote").addClass("changeInput_items"),$("#receipt_receiptAmount").addClass("changeMoney_items"),$("#receipt_uniformNum").addClass("changeUniformNum_items"),$("#receipt_receiptNum, #receipt_receiptDate, #receipt_receiptItem, #receipt_companyName, #receipt_adminNote, #receipt_receiptAmount, #receipt_uniformNum").removeClass("readOnly"),$("#receipt_status").addClass("changeSelectStatus2_items"),CustomInputHandlers.init(),$("#receipt_updateBtn").show()):(CustomInputHandlers.destroy(),$("#receipt_receiptNum").removeClass("changeInputUpperNumber_items"),$("#receipt_receiptDate").removeClass("changeDate_items"),$("#receipt_receiptItem, #receipt_companyName, #receipt_adminNote").removeClass("changeInput_items"),$("#receipt_receiptAmount").removeClass("changeMoney_items"),$("#receipt_uniformNum").removeClass("changeUniformNum_items"),$("#receipt_receiptNum, #receipt_receiptDate, #receipt_receiptItem, #receipt_companyName, #receipt_adminNote, #receipt_receiptAmount, #receipt_uniformNum").addClass("readOnly"),$("#receipt_status").removeClass("changeSelectStatus2_items"),$("#receipt_updateBtn").hide()),$("#receipt_updateBtn").on("click",function(){var e={id:t,receiptNum:$("#receipt_receiptNum").text(),receiptDate:$("#receipt_receiptDate").text(),receiptItem:$("#receipt_receiptItem").text(),amount:$("#receipt_receiptAmount").text(),companyName:$("#receipt_companyName").text(),uniformNum:$("#receipt_uniformNum").text(),status:$("#receipt_status").text(),adminNote:$("#receipt_adminNote").text()};e.receiptNum&&e.receiptDate&&e.receiptItem&&e.amount&&e.companyName&&e.uniformNum?($("#danger_receiptBox").text(""),$.ajax({url:receiptEditUrl,type:"POST",contentType:"application/json",data:JSON.stringify(e),success:function(e){swalToastSuccess(e.message,"top"),setTimeout(function(){location.reload()},2300)},error:function(e,t,a){console.error("Error:",a),swalToastWarning("儲存修改時發生錯誤，請稍後再試。","top")}})):$("#danger_receiptBox").text("請留下完整的資料，才可以儲存修改歐！")})}),$("#confirmPaymentModel").on("show.bs.modal",function(e){e=$(e.relatedTarget);let t=String(e.data("id"));$("#payment_updateBtn").off("click"),$("#danger_paymentBox").text(""),$("#payment_items").html("");var a,e=dataset_confirmPaymentAll.find(e=>e.id===t);e?($("#payment_companyName").text(e.company),$("#payment_uniformNum").text(e.uniformNum),"-"!=e.remittanceFile?(a=e.remittanceFile.length,"1"!=e.remittanceFile.substring(a-5,a-4)?$("#payment_downloadRemittanceFile").html(`<a class="d-inline me-3 text-nowrap" href="/download_T/T_${e.id}">下載&ensp;<i class="fa-solid fa-download"></i><span class="mx-1 update">補</span></a>`):$("#payment_downloadRemittanceFile").html(`<a class="d-inline me-3 text-nowrap" href="/download_T/T_${e.id}">下載&ensp;<i class="fa-solid fa-download"></i>`)):$("#payment_downloadRemittanceFile").text("-").addClass("readOnly"),$("#payment_companyEmail").text(e.companyEmail),$("#payment_contactPerson").text(e.contactPerson),$("#payment_companyPhone").text(e.companyPhone),$("#payment_paymentDate").text(e.paymentDate),$("#payment_paymentAmount").text(e.amount),$("#payment_last5AccountNo").text(e.last5AccountNo),e.items.forEach(function(e){e=`
                <li>
                    <span class="text-nowrap text-secondary">${e.type}</span>
                    <span class="text-nowrap">${e.description}</span>
                    <span class="text-nowrap text-danger">${e.amount}</span>
                </li>`;$("#payment_items").append(e)}),$("#gotoEditRemittance").attr("href","/Remittance/Edit/"+e.id),$("#payment_adminNote").text(e.adminNote),$("#payment_status").text(e.status)):console.error("paymentData not found for id:",t),"完成"===e.status||"取消"===e.status?(CustomInputHandlers.destroy(),$("#payment_adminNote").removeClass("changeInput_items"),$("#payment_status").removeClass("changeSelectStatus_items"),$("#payment_adminNote, #payment_status").addClass("readOnly"),$("#payment_updateBtn, #gotoEditRemittance").hide()):($("#payment_adminNote").addClass("changeInput_items"),$("#payment_status").addClass("changeSelectStatus_items"),$("#payment_adminNote, #payment_status").removeClass("readOnly"),CustomInputHandlers.init(),$("#payment_updateBtn, #gotoEditRemittance").show()),$("#payment_updateBtn").on("click",function(){var e={};e.id=t,e.adminNote=$("#payment_adminNote").text(),e.status=$("#payment_status").text(),$.ajax({url:paymentStatusEditUrl,type:"POST",contentType:"application/json",data:JSON.stringify(e),success:function(e){swalToastSuccess(e.message,"top"),setTimeout(function(){$("#confirmPaymentModel").modal("hide"),location.reload()},2300)},error:function(e,t,a){swalToastError("提交失敗，請稍後再試。","top")}})})}),$("#confirmPaymentCultivationModel").on("show.bs.modal",function(e){e=$(e.relatedTarget);let a=String(e.data("id")),i="";switch(a.substring(0,4)){case"now_":case"def_":i=a.substring(4);break;default:i=a.substring(5)}console.log("catchId:",a);let n=dataset_confirmPaymentCultivationRoom.find(e=>e.roomId==i),r=["#cultivation_receiptNum1","#cultivation_receiptNum2","#cultivation_receiptNum3","#cultivation_receiptNum4"],d=["#cultivation_deadline1","#cultivation_deadline2","#cultivation_deadline3","#cultivation_deadline4"],l=["#cultivation_label_receiptNum1","#cultivation_label_receiptNum2","#cultivation_label_receiptNum3","#cultivation_label_receiptNum4"],s=["#cultivation_label_deadline1","#cultivation_label_deadline2","#cultivation_label_deadline3","#cultivation_label_deadline4"],p=["#cultivation_label_installmentAmount1","#cultivation_label_installmentAmount2","#cultivation_label_installmentAmount3","#cultivation_label_installmentAmount4"],m=["#cultivation_installmentAmount1","#cultivation_installmentAmount2","#cultivation_installmentAmount3","#cultivation_installmentAmount4"],u="pinkBG",_="grayBG";if($("#cultivation_adminNote").addClass("changeInput_items"),$("#cultivation_startDate, #cultivation_endDate").addClass("changeDate_items"),$("#cultivation_uniformNum").addClass("changeUniformNum_items"),$("#cultivation_squareMeters").addClass("changeDecimal_items"),n){$("#cultivation_building").text(n.building),$("#cultivation_room").text(n.room);let o=null;var t,e=a.startsWith("now_"),c=a.startsWith("next_"),g=(e?o=n.now:c&&(o=n.next),console.log("currentData:",o),o&&o.id?$("#cultivation_deleteData, #cultivation_reminder").removeClass("d-none"):$("#cultivation_deleteData, #cultivation_reminder").addClass("d-none"),$("#cultivation_inputRate").val(o?.amount||n.defaultAmount),$("#cultivation_squareMeters").text(o?.squareMeters||n.defaultSquareMeters),$("#cultivation_startDate").text(o?.startDate||formatDate(new Date((new Date).setDate((new Date).getDate()+1)))),$("#cultivation_endDate").text(o?.endDate||formatDate(new Date((new Date).setFullYear((new Date).getFullYear()+1)))),o?.period||"1"),f=($("#cultivation_selectPeriod").val(g),$("#cultivation_companyName").text(o?.company||""),$("#cultivation_uniformNum").text(o?.uniformNum||""),$("#cultivation_responsiblePerson").text(o?.responsiblePerson||""),$("#cultivation_companyEmail").text(o?.companyEmail||""),$("#cultivation_contactPerson").text(o?.contactPerson||""),$("#cultivation_companyPhone").text(o?.companyPhone||""),$("#cultivation_deadline1").text(o?.deadline1||""),$("#cultivation_deadline2").text(o?.deadline2||""),$("#cultivation_deadline3").text(o?.deadline3||""),$("#cultivation_deadline4").text(o?.deadline4||""),parseFloat($("#cultivation_rate").text().replace(/,/g,"")));if(o)for(let e=1;e<=4;e++)o["receivableAmount"+e]?$("#cultivation_installmentAmount"+e).text(o["receivableAmount"+e]):g>=e&&(t=(12*f/g).toLocaleString(),$("#cultivation_installmentAmount"+e).text(t)),$("#cultivation_receiptNum"+e).text(o["receiptNum"+e]||""),$("#cultivation_receivedDate"+e).text(o["receivedDate"+e]||"");function N(){CustomInputHandlers.destroy();var e=$("#cultivation_selectPeriod").val(),t=parseFloat($("#cultivation_inputRate").val().replace(/,/g,""));if(isNaN(e)||isNaN(t))console.log("Invalid values for period or rate.");else{console.log("Valid values: Period -",e,"Rate -",t),l.forEach((e,t)=>{$(e).removeClass(u).removeClass(_),$(p[t]).removeClass(u).removeClass(_),$(s[t]).removeClass(u).removeClass(_),$(r[t]).removeClass("changeInput_items"),$(m[t]).removeClass("changeMoney_items"),$(d[t]).removeClass("changeDate_items")});{var c=e;let i=12*t,n=0,r=c;m.forEach((e,t)=>{let a=null;o&&o["receivableAmount"+(t+1)]&&(a=parseFloat(o["receivableAmount"+(t+1)].replace(/,/g,""))),!isNaN(a)&&t<c?(null!==a?$(e).text(a.toLocaleString()):$(e).text(""),n+=a,r--):t<c?(t=i-n,t=0<r?t/r:0,$(e).text(t.toLocaleString())):$(e).text("")})}var a=e;for(let e=0;e<a;e++)$(l[e]).addClass(u),$(p[e]).addClass(u),$(s[e]).addClass(u),$(r[e]).addClass("changeInput_items"),$(m[e]).addClass("changeMoney_items"),$(d[e]).addClass("changeDate_items");CustomInputHandlers.init()}}$("#cultivation_adminNote").text(o?.adminNote||""),N(),$("#cultivation_inputRate").on("input",function(){var e=$(this).val().trim();console.log("Rate changed:",e),N()}),$("#cultivation_selectPeriod").on("change",function(){var e=$(this).val();console.log("Period changed:",e),N()})}$("#cultivation_updateBtn").off("click"),$("#cultivation_deleteData").off("click"),$("#cultivation_deleteData").on("click",function(){console.log("使用Id",a);let e="";switch(a.substring(0,4)){case"now_":e=n.now.id;break;case"next":e=n.next.id;break;default:e="add"}$.ajax({url:deleteRoomRecordsUrl,type:"POST",contentType:"application/json",data:JSON.stringify(e),success:function(e){swalToastSuccess(e.message,"top"),setTimeout(function(){location.reload()},2300)},error:function(e,t,a){swalToastWarning("刪除配置紀錄時發生錯誤。","top")}})}),$("#cultivation_updateBtn").on("click",function(){console.log("roomId Btn :",a);let e="";switch(a.substring(0,4)){case"now_":e=n.now.id;break;case"next_":e=n.next.id;break;default:e="add"}var t={roomId:i,id:e,squareMeters:$("#cultivation_squareMeters").text(),amount:$("#cultivation_inputRate").val(),startDate:$("#cultivation_startDate").text(),endDate:$("#cultivation_endDate").text(),period:$("#cultivation_selectPeriod").val(),uniformNum:$("#cultivation_uniformNum").text(),deadline1:$("#cultivation_deadline1").text(),deadline2:$("#cultivation_deadline2").text(),deadline3:$("#cultivation_deadline3").text(),deadline4:$("#cultivation_deadline4").text(),receivableAmount1:$("#cultivation_installmentAmount1").text(),receivableAmount2:$("#cultivation_installmentAmount2").text(),receivableAmount3:$("#cultivation_installmentAmount3").text(),receivableAmount4:$("#cultivation_installmentAmount4").text(),receiptNum1:$("#cultivation_receiptNum1").text(),receiptNum2:$("#cultivation_receiptNum2").text(),receiptNum3:$("#cultivation_receiptNum3").text(),receiptNum4:$("#cultivation_receiptNum4").text(),adminNote:$("#receipt_adminNote").text()};console.log("roomUpdatedData:",t),t.startDate&&t.endDate&&t.period&&t.uniformNum&&t.deadline1&&t.receivableAmount1&&t.amount?($("#danger_roomBox").text(""),$.ajax({url:editRoomRecordsUrl,type:"POST",contentType:"application/json",data:JSON.stringify(t),success:function(e){console.log("更新成功:",e),swalToastSuccess(e.message,"top"),setTimeout(function(){location.reload()},2300)},error:function(e,t,a){console.error("更新失敗:",a),swalToastWarning("刪除配置紀錄時發生錯誤。","top")}})):$("#danger_roomBox").text("請留下完整的資料，才可以儲存修改歐！")})}),$("#confirmPaymentParkingSpaceModel").on("show.bs.modal",function(e){$("#parkingSapce_receiptNum1, #parkingSapce_receiptNum2, #parkingSapce_receiptNum3, #parkingSapce_receiptNum4, #parkingSapce_adminNote").addClass("changeInput_items"),$("#parkingSapce_startDate, #parkingSapce_endDate, #parkingSapce_deadline1, #parkingSapce_deadline2, #parkingSapce_deadline3, #parkingSapce_deadline4").addClass("changeDate_items"),$("#parkingSapce_rate").addClass("changeMoney_items"),$("#parkingSapce_licensePlateNum").addClass("changeInputUpperNumberHyphen_items"),CustomInputHandlers.init();var e=$(e.relatedTarget);let t=String(e.data("id"));console.log("parkingSpaceId 1 :",t),t.endsWith("_N")?(psId_N=t.slice(0,-2),(e=dataset_confirmPaymentParkingSpace.find(e=>e.psId===psId_N))?($("#parkingSapce_deleteData, #parkingSapce_reminder").addClass("d-none"),$("#parkingSapce_building").text(e.building),$("#parkingSapce_parkingSpaceNum").text(e.parkingSpaceNum),$("#parkingSapce_carType").text(e.carType),$("#parkingSapce_startDate").text(""),$("#parkingSapce_endDate").text(""),$("#parkingSapce_rate").text(e.amount),$("#parkingSapce_companyName").text(""),$("#parkingSapce_uniformNum").text(""),$("#parkingSapce_licensePlateNum").text(""),$("#parkingSapce_email").text(""),$("#parkingSapce_phone").text(""),$("#parkingSapce_applicant").text(""),$("#parkingSapce_deadline1").text(""),$("#parkingSapce_deadline2").text(""),$("#parkingSapce_deadline3").text(""),$("#parkingSapce_deadline4").text(""),$("#parkingSapce_receiptNum1").text(""),$("#parkingSapce_receiptNum2").text(""),$("#parkingSapce_receiptNum3").text(""),$("#parkingSapce_receiptNum4").text(""),$("#parkingSapce_receivedDate1").text(""),$("#parkingSapce_receivedDate2").text(""),$("#parkingSapce_receivedDate3").text(""),$("#parkingSapce_receivedDate4").text(""),$("#parkingSapce_adminNote").text("")):console.error("openRoomData data not found for id:",psId_N)):(e=dataset_confirmPaymentParkingSpace.find(e=>e.id===t))?($("#parkingSapce_deleteData, #parkingSapce_reminder").removeClass("d-none"),$("#parkingSapce_building").text(e.building),$("#parkingSapce_parkingSpaceNum").text(e.parkingSpaceNum),$("#parkingSapce_carType").text(e.carType),$("#parkingSapce_startDate").text(e.startDate),$("#parkingSapce_endDate").text(e.endDate),$("#parkingSapce_rate").text(e.amount),$("#parkingSapce_companyName").text(e.company),$("#parkingSapce_uniformNum").text(e.uniformNum),$("#parkingSapce_licensePlateNum").text(e.licensePlateNum),$("#parkingSapce_email").text(e.email),$("#parkingSapce_phone").text(e.phone),$("#parkingSapce_applicant").text(e.applicant),$("#parkingSapce_deadline1").text(e.deadline1),$("#parkingSapce_deadline2").text(e.deadline2),$("#parkingSapce_deadline3").text(e.deadline3),$("#parkingSapce_deadline4").text(e.deadline4),$("#parkingSapce_receiptNum1").text(e.receiptNum1),$("#parkingSapce_receiptNum2").text(e.receiptNum2),$("#parkingSapce_receiptNum3").text(e.receiptNum3),$("#parkingSapce_receiptNum4").text(e.receiptNum4),$("#parkingSapce_receivedDate1").text(e.receivedDate1),$("#parkingSapce_receivedDate2").text(e.receivedDate2),$("#parkingSapce_receivedDate3").text(e.receivedDate3),$("#parkingSapce_receivedDate4").text(e.receivedDate4),$("#parkingSapce_adminNote").text(e.adminNote)):console.error("openRoomData data not found for id:",roomId),$("#parkingSapce_updateBtn").off("click"),$("#parkingSapce_updateBtn").on("click",function(){console.log("psId 2 :",t),(updatedData={}).id=t,updatedData.contactPerson=$("#cultivation_squareMeters").text(),updatedData.startDate=$("#parkingSapce_startDate").text(),updatedData.endDate=$("#parkingSapce_endDate").text(),updatedData.amount=$("#parkingSapce_rate").text(),updatedData.licensePlateNum=$("#parkingSapce_licensePlateNum").text(),updatedData.deadline1=$("#parkingSapce_deadline1").text(),updatedData.deadline2=$("#parkingSapce_deadline2").text(),updatedData.deadline3=$("#parkingSapce_deadline3").text(),updatedData.deadline4=$("#parkingSapce_deadline4").text(),updatedData.receiptNum1=$("#parkingSapce_receiptNum1").text(),updatedData.receiptNum2=$("#parkingSapce_receiptNum2").text(),updatedData.receiptNum3=$("#parkingSapce_receiptNum3").text(),updatedData.receiptNum4=$("#parkingSapce_receiptNum4").text(),updatedData.adminNote=$("#parkingSapce_adminNote").text(),console.log(updatedData)}),$("#parkingSapce_deleteData").off("click"),$("#parkingSapce_deleteData").on("click",function(){(deleteData={}).id=t,swalConfirm("確定要刪除嗎？","是啊，這個沒用了...","不要阿 ~ 我是誤按！！",function(){console.log(deleteData)})})})}),$(function(){var a=$("#confirmPaymentReceiptList").DataTable(),i=$("#confirmPaymentAllList").DataTable(),n=$("#confirmPaymentCultivationRoomList").DataTable(),r=$("#confirmPaymentParkingSpaceList").DataTable();$('button[data-bs-toggle="pill"]').on("shown.bs.tab",function(e){var t;switch($(e.target).data("bs-target")){case'#pills-one"':t=a;break;case"#pills-two":t=i;break;case"#pills-three":t=n;break;case"#pills-four":t=r}t&&setTimeout(function(){t.columns.adjust().responsive.recalc()},30)})}),$(function(){function e(){var e;switch($("#type").val()){case"識別證":e=idCardData;break;case"機車位":e=parkingSpaceMotoData;break;case"汽車位":e=parkingSpaceCarData;break;case"培育室":e=roomData}$("#typeahead_itemNum").typeahead("destroy"),$("#typeahead_itemNum").typeahead({source:e})}$("#typeahead_company, #typeahead_receiptCompanyAdd").typeahead({source:companyData}),$("#type").change(e),e()});