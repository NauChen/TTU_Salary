$(function(){$("#accountProfilesList").DataTable({...commonSettingsTable,data:dataset_userList,columns:[{data:"createDate",title:"建立日期"},{data:"name",title:"使用者"},{data:"userId",title:"登入帳號"},{data:"type",title:"用戶類型"},{data:"editBy",title:"最後改動者",render:function(t,e,a){let o="";return o=a.name==t?"自己":t}},{data:"id",title:"詳情",render:function(t,e,a){let o="",n="",s="";return"培育廠商"===a.type?(o='<i class="fa-solid fa-briefcase"></i>',n="companyDetailModal",s="info"):(n="personalDetailModal",s="primary",o="神秘客"===a.type?'<i class="fa-solid fa-skull"></i>':'<i class="fa-solid fa-user"></i>'),'<button type="button" class="btn btn-outline-'+s+' btn-sm" data-bs-toggle="modal" data-bs-target="#'+n+'" data-id="'+t+'">'+o+"</button>"}},{data:"id",title:"修改",render:function(t,e,a){let o=linkPage="";return'<a class="btn btn-outline-'+(o="培育廠商"===a.type?(linkPage="../CoopManuf/Edit/","info"):(linkPage="../User/Edit/","primary"))+' rounded-circle btn-sm oneWord" href="'+linkPage+t+'"><i class="fa-solid fa-wrench"></i></a>'}},{data:"id",title:"訪視<br class='d-none d-lg-block'>紀錄",render:function(t,e,a){return"培育廠商"===a.type?'<a class="btn btn-outline-info rounded-circle btn-sm oneWord" href="../CoopManuf/VisitReport/'+t+'"><i class="fa-solid fa-user-secret"></i></a>':""}},{data:"status",visible:!1}],order:[[8,"desc"],[0,"desc"],[3,"desc"]],columnDefs:[{targets:[1],responsivePriority:1},{targets:[2],responsivePriority:2},{searchable:!1,orderable:!1,targets:[5,6,7]},{className:"text-nowrap",targets:[0,2,3]},{className:"text-lg-center",targets:[0,3,5,6,7,8]}],createdRow:function(e,t,a){"停用"==t.status&&$("td",e).css("color","#999"),[5,6,7].forEach(function(t){$("td:eq("+t+")",e).css("max-width","70px")}),$("td:eq(3)",e).css("max-width","100px"),[0,2,4].forEach(function(t){$("td:eq("+t+")",e).css("font-size",".9em")}),"刪除"==t.status&&$("td",e).css({color:"#999","text-decoration":"line-through"})}}),$("#companyDetailModal").on("show.bs.modal",function(t){t=$(t.relatedTarget);let e=String(t.data("id"));console.log("this Id:",e);t=dataset_userList.find(t=>t.id===e);if(t){$("#companyName").text(t.name),$("#createDate").text(t.createDate),$("#companyDescription").text(t.companyDetails.companyDescription),$("#uniformNum").text(t.companyDetails.uniformNum),$("#creationDate").text(t.companyDetails.creationDate),$("#capitalAmount").text(t.companyDetails.capitalAmount),$("#employeesNum").text(t.companyDetails.employeesNum),$("#responsiblePerson").text(t.companyDetails.responsiblePerson),$("#referrer").text(t.companyDetails.referrer),$("#phoneNum").text(t.companyDetails.phone),$("#companyEmail").text(t.companyDetails.companyEmail),$("#lineId").text(t.companyDetails.lineId),$("#contactPerson").text(t.companyDetails.contactPerson),$("#ext").text(t.companyDetails.ext),$("#jobTitle").text(t.companyDetails.jobTitle),$("#companyAdd").text(t.companyDetails.companyAdd),$("#locationOfCompany").text(t.companyDetails.locationOfCompany),$("#helpItems").text(t.companyDetails.helpItems),$("#tutoringProfessor").text(t.companyDetails.tutoringProfessor),$("#nurtureProgram").text(t.companyDetails.nurtureProgram),$("#adminNote").text(t.companyDetails.adminNoteWithCompany);let e="";function o(t,e,a,o){return t&&e?extractSubstringBetween(t,"_",".")===o+"1"?`<a class="d-inline me-3" href="../DownloadInformation/${o}_${e}">${a}&ensp;<i class="fa-solid fa-download"></i></a>`:`<a class="d-inline me-3" href="../DownloadInformation/${o}_${e}">${a}&ensp;<i class="fa-solid fa-download"></i><span class="mx-1 update">補</span></a>`:""}let a=t.companyDetails.id;t.companyDetails&&(t.companyDetails.companyProof&&(e+=o(t.companyDetails.companyProof,a,"公司登記證","CP")),t.companyDetails.businessProof&&(e+=o(t.companyDetails.businessProof,a,"營利事業登記證或預查名稱表影本","BP")),t.companyDetails.memoOfCooperation&&(e+=o(t.companyDetails.memoOfCooperation,a,"企業與大同大學教職員簽訂之合作備忘錄","MOC")),t.companyDetails.planConcept&&(e+=o(t.companyDetails.planConcept,a,"企業營運計畫構想書","PC")),t.companyDetails.entryForm&&(e+=o(t.companyDetails.entryForm,a,"創新育成中心進駐申請書","EF")),t.companyDetails.consentDoc&&(e+=o(t.companyDetails.consentDoc,a,"同意審查聲明書","CD")),t.companyDetails.payProof)&&(e+=o(t.companyDetails.payProof,a,"進駐審查費繳費證明","PP")),t.entryContract&&Array.isArray(t.entryContract)&&t.entryContract.forEach(t=>{t.FEC_FileName&&(e+=o(t.FEC_FileName,a+"_"+t.FEC_Id,`合約書(${t.FEC_Note})`,"EC"))}),$("#downloadLinksContainer").html(e)}else console.error("companyData data not found for id:",thisCPId)}),$("#personalDetailModal").on("show.bs.modal",function(t){t=$(t.relatedTarget);let e=String(t.data("id"));t=dataset_userList.find(t=>t.id===e);t?($("#personal_Name").text(t.name),$("#personal_createDate").text(t.createDate),$("#personal_userName").text(t.userId),$("#personal_adminNote").text(t.adminNote)):console.error("personalData data not found for id:",e)})});