var dataset_myCultivationRoom=[{id:"1",startDate:"2023-10-01",endDate:"2024-09-31",building:"新德惠大樓",room:"101",thisTimeDeadline:"2024-09-30",nextTimeDeadline:"",paymentDate:"2024-03-31",remark:""},{id:"2",startDate:"2023-08-31",endDate:"2024-08-30",building:"綜合大樓",room:"104",thisTimeDeadline:"",nextTimeDeadline:"",paymentDate:"2024-08-31",remark:""},{id:"3",startDate:"2023-11-01",endDate:"2024-10-30",building:"挺生大樓",room:"105",thisTimeDeadline:"2024-11-01",nextTimeDeadline:"",paymentDate:"2024-09-01",remark:""},{id:"4",startDate:"2023-11-11",endDate:"2024-11-10",building:"實驗大樓",room:"106",thisTimeDeadline:"2024-11-10",nextTimeDeadline:"",paymentDate:"2024-09-05",remark:""},{id:"5",startDate:"2024-06-01",endDate:"2025-05-31",building:"實驗大樓",room:"201",thisTimeDeadline:"2024-12-31",nextTimeDeadline:"2025-03-31",paymentDate:"2024-09-25",remark:""},{id:"6",startDate:"2024-07-01",endDate:"2025-06-31",building:"北設工大樓",room:"202",thisTimeDeadline:"2025-10-31",nextTimeDeadline:"2025-01-31",paymentDate:"",remark:""},{id:"7",startDate:"2024-09-01",endDate:"2025-08-31",building:"尚志大樓",room:"A4-102",thisTimeDeadline:"2025-03-01",nextTimeDeadline:"2025-08-31",paymentDate:"",remark:""},{id:"8",startDate:"2024-02-01",endDate:"2025-01-31",building:"新德惠大樓",room:"A4-103",thisTimeDeadline:"2024-09-30",nextTimeDeadline:"",paymentDate:"",remark:""},{id:"9",startDate:"2023-06-01",endDate:"2024-05-31",building:"綜合大樓",room:"714",thisTimeDeadline:"",nextTimeDeadline:"",paymentDate:"2024-05-15",remark:""},{id:"10",startDate:"2024-08-01",endDate:"2025-07-31",building:"挺生大樓",room:"809",thisTimeDeadline:"2024-10-01",nextTimeDeadline:"2025-01-01",paymentDate:"",remark:""}];$(function(){let o=new Date;function n(e,t){e=e.getTime()-t.getTime(),t=Math.ceil(e/864e5);return t<0?null:t}dataset_myCultivationRoom.forEach(e=>{var t=new Date(e.endDate),t=(e.endDiffDays=n(t,o),console.log(`id = ${e.id} ，結束日期： ${e.endDate} ，今日： 2024-09-06 ，差： `+e.endDiffDays),new Date(e.thisTimeDeadline)),a=new Date(e.nextTimeDeadline);let i;i=isNaN(a.getTime())?n(t,o):n(a,o),e.deadLineDiffDays=i,console.log(`id = ${e.id} ，期限日期： ${"Invalid Date"===a.toString()?e.thisTimeDeadline:e.nextTimeDeadline} ，今日： 2024-09-06 ，差： `+e.deadLineDiffDays);t=new Date(e.paymentDate);e.payDiffDays=n(t,o),console.log(`id = ${e.id} ，付款期限： ${e.paymentDate} ，差： `+e.payDiffDays)}),$("#myRenewContracList").DataTable({...commonSettingsProvision,layout:{topStart:function(){var e=document.createElement("div");return e.innerHTML='<h6 class="fw-bold"><i class="fa-solid fa-circle-exclamation mx-1"></i>若要續用，請於到期前申請續約。</h6>',e}},data:dataset_myCultivationRoom,columns:[{data:"startDate",title:"進駐開始"},{data:"endDate",title:"進駐結束"},{data:"building",title:"進駐區域"},{data:"room",title:"室"},{data:"thisTimeDeadline",title:"本階段<br class='d-none d-lg-block'>到期日",render:function(e){return e||"-"}},{data:"nextTimeDeadline",title:"下階段<br class='d-none d-lg-block'>到期日",render:function(e){return e||"-"}},{data:"paymentDate",title:"最新<br class='d-none d-lg-block'>付款日",render:function(e){return e||"-"}},{data:"remark",title:"備註"},{data:"id",title:"續約",render:function(e,t,a){return a.endDiffDays?a.endDiffDays<50?'<a class="btn btn-outline-primary rounded-circle btn-sm oneWord" href="./renewContractApply.html?id='+e+'" title="立即續約"><i class="fa-solid fa-repeat"></i></a>':'<button type="button" class="btn btn-light rounded-circle btn-sm" title="續約時間未到"><i class="fa-solid fa-hourglass-half"></i></button>':""}},{data:"id",visible:!1,render:function(e,t,a){var{endDate:a,thisTimeDeadline:i,nextTimeDeadline:n}=a;return new Date(a)<o?"9999-99-99":n&&""!==n?n:i}}],order:[[9,"asc"]],columnDefs:[{targets:[1],responsivePriority:1},{targets:[2],responsivePriority:2},{targets:[3],responsivePriority:3},{searchable:!1,orderable:!1,targets:[8]},{className:"text-lg-center",targets:[0,1,3,4,5,6,8]},{className:"text-nowrap",targets:[0,1,3,4,5,6,8]}],createdRow:function(t,e,a){e.endDiffDays||$("td",t).css("color","#999"),$("td:eq(8)",t).css("max-width","70px"),[0,1,4,5,6].forEach(function(e){$("td:eq("+e+")",t).css("font-size",".9em")})}}),$(".uploadRemittance, .reuploadRemittance").click(function(e){clearValues(["danger_paymentDate","danger_paymentAmount","danger_last5AccountNo","paymentDate","paymentAmount","last5AccountNo","last5AccountNo","remittancePdf"]);var t,a=session_userData,a=($("#company").val(a.company),$(this));let i=a.data("id");i?(t=dataset_myCultivationRoom.find(e=>e.id==i))?($("#dataId").val(t.id),$("#type").val("培育室"),$("#paymentPurpose").val("階段費用"),$("#itemNum").val(t.building+"-"+t.room),a.hasClass("reuploadRemittance")&&(e.preventDefault(),swalConfirm("曾填過匯款通知，要再填一次嗎?","對，我要重新填寫上傳。","不，回到上一步。",function(){$("#remittanceModal").modal("show")}))):console.error("cultivationRoom data not found for id:",i):console.error("cultivationRoom ID not found in URL")}),$(".thisRequired").on("input change",function(){checkThisRequiredElements.call(this)}),$("#remittanceSubmit").click(function(e){var t;checkRequiredElements()?checkDangerElements()?(console.log("表單資料已送出"),t=$("#formRemittance").serializeArray(),console.log("表單資料：",JSON.stringify(t,null,2))):swalToastWarning("請填上正確資料唷！","top"):swalToastWarning("請將必填欄位填上正確資料唷！","top")})});